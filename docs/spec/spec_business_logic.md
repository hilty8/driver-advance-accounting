# ビジネスロジック

## 前借り承認時

- 元本 `P = 申請金額`
- 手数料 `F = ceil(P * 0.05)`
- 振込額 `A = P - F`
- 前借り残高に元本を加算

## 振込指示/完了

- 承認後に必要に応じて「振込指示済み」ステータスを挟む。
- 振込完了で `paid` に更新。

## 給与支給時の回収

- 回収額 `C = min(給与額 S, 前借り残高 B)`
- 実支給額 `net_salary = S - C`
- 回収後の残高が 0 になった前借りは `settled` とする。

## 貸倒

- 回収不能と判断した残高を「貸倒」として記録する。
- 貸倒額は集計対象として保持する。

## 回収率

- `collection_rate = total_collected / total_disbursed`
- 貸倒の扱いは別途集計する。
